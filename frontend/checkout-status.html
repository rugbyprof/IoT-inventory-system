<!DOCTYPE html>
<html>
  <head>
    <title>My Checkout Requests</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h2>My Checkout Requests</h2>
      <table id="status-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Component</th>
            <th>Quantity</th>
            <th>Status</th>
            <th>Reason</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <script>
      const token = localStorage.getItem("token");
      if (!token) {
        alert("Login required");
        window.location.href = "admin-login.html";
      }

      fetch("http://localhost:3000/api/checkout/my-requests", {
        headers: { Authorization: "Bearer " + token },
      })
        .then((res) => res.json())
        .then((data) => {
          const tbody = document.querySelector("#status-table tbody");
          tbody.innerHTML = "";
          data.forEach((row) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
        <td>${row.id}</td>
        <td>${row.component}</td>
        <td>${row.quantity}</td>
        <td>${row.status}</td>
        <td>${row.rejection_reason || "-"}</td>
        <td>${new Date(row.checkout_date).toLocaleString()}</td>
      `;
            tbody.appendChild(tr);
          });
        });
    </script>
  </body>
</html>
